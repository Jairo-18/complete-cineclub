import{a as b}from"./chunk-HI5P6VLK.js";import{Nc as f,Tc as m,V as c,_ as p,g as u}from"./chunk-4XNWJBNU.js";import{a as o,b as l,i}from"./chunk-ODN5LVDJ.js";var d=class a{supabase=b;_httpClient=p(f);currentUser=new u(null);get currentUserValue(){return this.currentUser.value}getProfile(e){return i(this,null,function*(){let{data:r,error:t}=yield this.supabase.from("profile").select("id, fullName, country, username, bibliography, phone, email, created_at").eq("id",e).single();return t?(console.error("Error obteniendo perfil:",t),null):r})}getCurrentUserProfile(){return i(this,null,function*(){let e=this.currentUserValue;return e?yield this.getProfile(e.id):null})}updateProfile(e,r){return i(this,null,function*(){let t=(yield this.supabase.auth.getSession()).data.session?.user.email||"";if(yield this.getProfile(e)){let{data:n,error:s}=yield this.supabase.from("profile").update(l(o({},r),{email:t})).eq("id",e).select().single();if(s)throw console.error("Error actualizando perfil:",s),s;return n}else{let{data:n}=yield this.supabase.from("profile").insert(o({id:e,email:t},r)).select().single();return n}})}shareCollection(e){return this._httpClient.post(`${m.backendUrl}collections/requests/share/${e}`,{})}static \u0275fac=function(r){return new(r||a)};static \u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})};export{d as a};
