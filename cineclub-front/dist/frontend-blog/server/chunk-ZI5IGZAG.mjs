import './polyfills.server.mjs';
import{a as ke}from"./chunk-VRKUPS3B.mjs";import{a as Fe}from"./chunk-7ZPJTXPL.mjs";import{g as De,h as Re}from"./chunk-JGNX5KPE.mjs";import{a as Me,b as be}from"./chunk-LYFFEPC2.mjs";import{a as ye,b as Se,c as Ee}from"./chunk-GRXIXLG2.mjs";import{d as K,g as Q}from"./chunk-SN4ZLEXK.mjs";import{a as ee,b as te}from"./chunk-IZYF7JLB.mjs";import{b as we,c as xe}from"./chunk-DMVK7NGP.mjs";import{A as he,D as Ce,E as _e,e as ie,g as h,j as oe,k as ne,m as ae,o as re,p as le,q as se,r as me,s as ce,t as de,v as pe,w as ue,x as ge,y as ve,z as fe}from"./chunk-R2LPZPTP.mjs";import{l as X,n as Y,o as Z}from"./chunk-37XX4R2Q.mjs";import{b as W,c as I}from"./chunk-QHGSIMU3.mjs";import{A as O,Db as k,E as P,Gb as C,Ha as B,Ib as x,La as r,Sb as j,Ub as z,Uc as $,Vc as J,Wb as l,Xa as w,Xb as f,Yb as _,_ as F,_c as M,ab as G,da as d,ea as p,ec as H,fa as V,ga as L,gc as U,nb as u,o as A,ob as g,pb as N,qb as q,rb as y,sb as S,tb as c,ub as o,vb as a,wb as v}from"./chunk-I37AKPGM.mjs";function Be(n,e){if(n&1&&(o(0,"span",18),l(1," \u2605 "),a()),n&2){let i=e.$implicit;z("text-orange-400",i)("text-gray-300",!i)}}var T=class n{title="";description="";image="";author="";tag="";score=0;likes=0;comments=0;get stars(){return Array(5).fill(!1).map((e,i)=>i<this.score)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=w({type:n,selectors:[["app-card-recomendations"]],inputs:{title:"title",description:"description",image:"image",author:"author",tag:"tag",score:"score",likes:"likes",comments:"comments"},decls:26,vars:9,consts:[[1,"bg-[#F0F4F9]","rounded-lg","p-6","w-full","md:w-full","lg:w-full","2xl:w-full","3xl:w-full","shadow-lg","border-[0.5px]","border-[#757575]"],[1,"flex","flex-col","md:flex-col","lg:flex-col","2xl:flex-row","gap-3","md:gap-6"],[1,"w-32","h-48","object-cover","rounded-lg","shadow-xl","flex-shrink-0","border-[0.5px]","border-[#757575]",3,"src","alt"],[1,"flex-1"],[1,"flex","flex-col","md:flex-col","2xl:flex-row","items-start","justify-between","mb-2"],[1,"text-xl","md:text-3xl","font-bold","text-gray-900"],[1,"flex","md:hidden","text-gray-600","text-base","md:text-lg"],[1,"flex","gap-0.5","ml-0","md:ml-4","lg:ml-0"],["class","text-2xl",3,"text-orange-400","text-gray-300",4,"ngFor","ngForOf"],[1,"hidden","md:flex","text-gray-600","text-base","md:text-lg","mb-3"],[1,"text-gray-700","text-xs","md:text-base","leading-relaxed","mb-3","md:mb-6"],[1,"flex","gap-4"],[1,"flex","items-center","gap-2","text-gray-700","hover:text-red-500","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","stroke-width","2",1,"w-4","md:w-6","h-4","md:h-6"],["d","M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"],[1,"text-sm","md:text-lg"],[1,"flex","items-center","gap-2","text-gray-700","hover:text-blue-500","transition-colors"],["d","M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"],[1,"text-2xl"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"div",1),v(2,"img",2),o(3,"div",3)(4,"div",4)(5,"h2",5),l(6),a(),o(7,"p",6),l(8),a(),o(9,"div",7),G(10,Be,2,4,"span",8),a()(),o(11,"p",9),l(12),a(),o(13,"p",10),l(14),a(),o(15,"div",11)(16,"button",12),V(),o(17,"svg",13),v(18,"path",14),a(),L(),o(19,"span",15),l(20),a()(),o(21,"button",16),V(),o(22,"svg",13),v(23,"path",17),a(),L(),o(24,"span",15),l(25),a()()()()()()),i&2&&(r(2),c("src",t.image,B)("alt",t.title),r(4),f(t.title),r(2),f(t.author),r(2),c("ngForOf",t.stars),r(2),f(t.author),r(2),_(" ",t.description," "),r(6),f(t.likes),r(5),f(t.comments))},dependencies:[M,J,I],encapsulation:2})};var Ve=[{title:"El Se\xF1or de los Anillos",author:"J.R.R. Tolkien",description:"Una \xE9pica de alta fantas\xEDa que narra el viaje del hobbit Frodo Bols\xF3n para destruir el Anillo \xDAnico y as\xED acabar con el Se\xF1or Oscuro, Sauron.",image:"assets/images/optimusprain.jpg",score:5,likes:1023,comments:150},{title:"Cien a\xF1os de soledad",author:"Gabriel Garc\xEDa M\xE1rquez",description:"La historia de la familia Buend\xEDa a lo largo de siete generaciones en el pueblo ficticio de Macondo. Una obra maestra del realismo m\xE1gico.",image:"assets/images/optimusprain.jpg",score:5,likes:876,comments:120},{title:"1984",author:"George Orwell",description:"Una novela dist\xF3pica que presenta una sociedad totalitaria y la lucha de un hombre contra el omnipresente control del Partido y su l\xEDder, Gran Hermano.",image:"assets/images/optimusprain.jpg",score:4,likes:750,comments:95}];function Ge(n,e){if(n&1&&v(0,"app-card-recomendations",2),n&2){let i=e.$implicit;c("title",i.title??"")("author",i.author??"")("description",i.description??"")("image",i.image??"")("score",i.score??0)("likes",i.likes??0)("comments",i.comments??0)}}var Le=class n{books=Ve;static \u0275fac=function(i){return new(i||n)};static \u0275cmp=w({type:n,selectors:[["app-books-content"]],decls:4,vars:0,consts:[[1,"container","mx-auto","px-4","py-4","text-black"],[1,"grid","gap-6"],[3,"title","author","description","image","score","likes","comments"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"div",1),y(2,Ge,1,7,"app-card-recomendations",2,N),a()()),i&2&&(r(2),S(t.books))},dependencies:[T,M],encapsulation:2})};var Ne=()=>[1,2,3,4,5],qe=(n,e)=>({"text-yellow-400":n,"text-gray-300":e}),je=(n,e)=>e.id;function ze(n,e){n&1&&(o(0,"mat-icon",7),v(1,"mat-spinner",24),a())}function He(n,e){if(n&1){let i=k();o(0,"button",25),C("click",function(){d(i);let s=x();return p(s.clearMovieSelection())}),o(1,"mat-icon"),l(2,"clear"),a()()}}function Ue(n,e){if(n&1&&(o(0,"mat-option",10),l(1),a()),n&2){let i=e.$implicit;c("value",i),r(),_(" ",i.title," ")}}function $e(n,e){n&1&&(o(0,"mat-option",11)(1,"span",26),l(2,"No se encontraron pel\xEDculas"),a()())}function Je(n,e){n&1&&(o(0,"mat-error"),l(1,"La pel\xEDcula es requerida"),a())}function We(n,e){if(n&1){let i=k();o(0,"mat-icon",27),C("click",function(){let s=d(i).$implicit,m=x();return p(m.setRating(s))})("mouseenter",function(){let s=d(i).$implicit,m=x();return p(m.setHoverRating(s))})("mouseleave",function(){d(i);let s=x();return p(s.clearHoverRating())}),l(1),a()}if(n&2){let i=e.$implicit,t=x();c("ngClass",U(2,qe,t.hoveredRating>=i||t.rating>=i,t.hoveredRating<i&&t.rating<i)),r(),_(" ",t.getStarIcon(i)," ")}}function Ke(n,e){n&1&&(o(0,"span",17),l(1,"La calificaci\xF3n es requerida, m\xEDnimo 0.5 estrellas"),a())}function Qe(n,e){n&1&&(o(0,"mat-error"),l(1,"La rese\xF1a es requerida"),a())}function Xe(n,e){n&1&&(o(0,"mat-error"),l(1,"La rese\xF1a debe tener al menos 10 caracteres"),a())}function Ye(n,e){n&1&&(o(0,"mat-error"),l(1,"La rese\xF1a no puede exceder los 500 caracteres"),a())}var Ae=class n{dialogRef=F(Me);fb=F(de);moviesService=F(ke);data=F(be);reviewForm;movies=[];filteredMovies=[];movieFilterControl=new ae("");isLoadingMovies=!1;rating=0;hoveredRating=0;isEditMode=!1;ngOnInit(){if(this.isEditMode=this.data?.isEdit||!1,this.reviewForm=this.fb.group({content:["",[h.required,h.minLength(10),h.maxLength(500)]],rating:[0,[h.required,h.min(.5),h.max(5)]],movieId:["",this.isEditMode?[]:h.required]}),this.isEditMode&&this.data?.reviewData){this.reviewForm.patchValue({content:this.data.reviewData.content,rating:this.data.reviewData.rating}),this.rating=this.data.reviewData.rating;let e=this.data.reviewData.movieTitle;e?setTimeout(()=>{this.movieFilterControl.setValue(e),this.movieFilterControl.disable()}):(console.warn("No se encontr\xF3 movieTitle en reviewData"),this.movieFilterControl.disable())}else this.setupMovieAutocomplete()}fetchMovies(){this.isLoadingMovies=!0;let e={page:1,size:10};this.moviesService.getMoviesWithPagination(e).subscribe({next:i=>{this.movies=i.data,this.filteredMovies=this.movies,this.isLoadingMovies=!1},error:i=>{console.error("Error fetching movies:",i),this.isLoadingMovies=!1}})}setupMovieAutocomplete(){this.movieFilterControl.valueChanges.pipe(A(e=>typeof e=="string"?e:e?.title??""),O(700),P()).subscribe(e=>{this.searchMovies(e)})}searchMovies(e){if(!e||e.length<2){this.fetchMovies();return}this.isLoadingMovies=!0;let i={page:1,size:10,title:e.trim()};this.moviesService.getMoviesWithPagination(i).subscribe({next:t=>{this.filteredMovies=t.data||[],this.isLoadingMovies=!1},error:t=>{console.error("Error searching movies:",t),this.isLoadingMovies=!1,this.filteredMovies=[]}})}onMovieFocus(){!this.filteredMovies.length&&!this.movieFilterControl.value&&this.fetchMovies()}onMovieBlur(){this.reviewForm.get("movieId")?.markAsTouched()}setRating(e){this.rating=e,this.reviewForm.patchValue({rating:e}),this.reviewForm.get("rating")?.markAsTouched()}setHoverRating(e){this.hoveredRating=e}clearHoverRating(){this.hoveredRating=0}getStarIcon(e){let i=this.hoveredRating||this.rating;return i>=e?"star":i>=e-.5?"star_half":"star_outline"}onMovieSelected(e){let i=e.option.value;i&&i.id&&this.reviewForm.patchValue({movieId:i.id})}clearMovieSelection(){this.reviewForm.patchValue({movieId:""}),this.movieFilterControl.setValue("")}get showNoResultsMessage(){let e=this.movieFilterControl.value,i=typeof e=="string"?e:"";return!this.isLoadingMovies&&this.filteredMovies.length===0&&!!i&&i.length>=2}displayMovie(e){return typeof e=="string"?e:e?.title||""}submitReview(){if(this.reviewForm.markAllAsTouched(),this.reviewForm.valid){let e={content:this.reviewForm.value.content,rating:this.reviewForm.value.rating,movieId:this.reviewForm.value.movieId};this.dialogRef.close(e)}}cancelAction(){this.dialogRef.close(null)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=w({type:n,selectors:[["app-create-review-dialog"]],decls:43,vars:20,consts:[["movieAuto","matAutocomplete"],[3,"title","description"],["form",""],[1,"flex","flex-col","gap-1",3,"formGroup"],["appearance","outline",1,"w-full"],["type","text","matInput","",3,"focus","blur","matAutocomplete","formControl","placeholder"],["matPrefix","",1,"icon-small"],["matSuffix",""],["matSuffix","","mat-icon-button","","type","button","matTooltip","Limpiar selecci\xF3n"],[3,"optionSelected","displayWith"],[3,"value"],["disabled",""],[1,"flex","flex-col","gap-2"],["for","rating-display",1,"text-sm","font-medium","text-gray-700"],[1,"flex","gap-1","items-center","w-full"],[1,"star-icon","cursor-pointer",3,"ngClass"],["id","rating-display",1,"text-sm","text-gray-600"],[1,"text-red-600","text-xs"],["matInput","","formControlName","content","rows","5","placeholder","Escribe tu opini\xF3n sobre la pel\xEDcula...","maxlength","500"],["align","end"],["actions","",1,"w-full"],[1,"flex","content-between","gap-x-2"],["mat-fab","","extended","true","color","warn",1,"!w-[50%]",3,"click"],["mat-fab","","extended","true","color","primary",1,"!w-[50%]",3,"click","disabled"],["diameter","20"],["matSuffix","","mat-icon-button","","type","button","matTooltip","Limpiar selecci\xF3n",3,"click"],[1,"text-gray-500"],[1,"star-icon","cursor-pointer",3,"click","mouseenter","mouseleave","ngClass"]],template:function(i,t){if(i&1){let s=k();o(0,"app-base-dialog",1)(1,"div",2)(2,"form",3)(3,"mat-form-field",4)(4,"mat-label"),l(5),a(),o(6,"input",5),C("focus",function(){return d(s),p(t.onMovieFocus())})("blur",function(){return d(s),p(t.onMovieBlur())}),a(),o(7,"mat-icon",6),l(8,"movie"),a(),u(9,ze,2,0,"mat-icon",7),u(10,He,3,0,"button",8),o(11,"mat-autocomplete",9,0),C("optionSelected",function(b){return d(s),p(t.onMovieSelected(b))}),y(13,Ue,2,2,"mat-option",10,je),u(15,$e,3,0,"mat-option",11),a(),u(16,Je,2,0,"mat-error"),a(),o(17,"div",12)(18,"mat-label",13),l(19,"Calificaci\xF3n"),a(),o(20,"div",14),y(21,We,2,5,"mat-icon",15,q),a(),o(23,"span",16),l(24),a(),u(25,Ke,2,0,"span",17),a(),o(26,"mat-form-field",4)(27,"mat-label"),l(28,"Tu rese\xF1a"),a(),v(29,"textarea",18),o(30,"mat-icon",6),l(31,"rate_review"),a(),o(32,"mat-hint",19),l(33),a(),u(34,Qe,2,0,"mat-error"),u(35,Xe,2,0,"mat-error"),u(36,Ye,2,0,"mat-error"),a()()(),o(37,"div",20)(38,"section",21)(39,"button",22),C("click",function(){return d(s),p(t.cancelAction())}),l(40," Cancelar "),a(),o(41,"button",23),C("click",function(){return d(s),p(t.submitReview())}),l(42," Publicar "),a()()()()}if(i&2){let s,m,b,E,D,R,Oe=j(12);c("title",(t.data==null?null:t.data.title)||"Crear Rese\xF1a")("description",(t.data==null?null:t.data.message)||"Comparte tu opini\xF3n sobre esta pel\xEDcula"),r(2),c("formGroup",t.reviewForm),r(3),f(t.isEditMode?"Pel\xEDcula":"Buscar pel\xEDcula"),r(),c("matAutocomplete",Oe)("formControl",t.movieFilterControl)("placeholder",t.isEditMode?"":"T\xEDtulo de la pel\xEDcula..."),r(3),g(t.isLoadingMovies?9:-1),r(),g(t.movieFilterControl.value&&!t.isLoadingMovies&&!t.isEditMode?10:-1),r(),c("displayWith",t.displayMovie),r(2),S(t.filteredMovies),r(2),g(t.showNoResultsMessage?15:-1),r(),g((s=t.reviewForm.get("movieId"))!=null&&s.hasError("required")&&((s=t.reviewForm.get("movieId"))!=null&&s.touched)?16:-1),r(5),S(H(19,Ne)),r(3),_("",t.rating," estrellas"),r(),g(((m=t.reviewForm.get("rating"))!=null&&m.hasError("required")||(m=t.reviewForm.get("rating"))!=null&&m.hasError("min"))&&((m=t.reviewForm.get("rating"))!=null&&m.touched)?25:-1),r(8),_("",((b=t.reviewForm.get("content"))==null||b.value==null?null:b.value.length)||0,"/500 caracteres"),r(),g((E=t.reviewForm.get("content"))!=null&&E.hasError("required")&&((E=t.reviewForm.get("content"))!=null&&E.touched)?34:-1),r(),g((D=t.reviewForm.get("content"))!=null&&D.hasError("minlength")&&((D=t.reviewForm.get("content"))!=null&&D.touched)?35:-1),r(),g((R=t.reviewForm.get("content"))!=null&&R.hasError("maxlength")&&((R=t.reviewForm.get("content"))!=null&&R.touched)?36:-1),r(5),c("disabled",!t.reviewForm.valid)}},dependencies:[Fe,Z,X,Y,_e,Ce,ue,ve,ge,fe,he,xe,we,Ee,ye,K,Se,I,W,Q,te,ee,Re,De,pe,re,ie,oe,ne,ce,le,se,me,M,$],styles:[".star-icon[_ngcontent-%COMP%]{transition:all .2s ease;-webkit-user-select:none;user-select:none}.star-icon[_ngcontent-%COMP%]:hover{transform:scale(1.1)}mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}button[mat-fab][_ngcontent-%COMP%]{min-width:120px}"]})};export{Le as a,Ae as b};
